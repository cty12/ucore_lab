# Lab 3 Report

## Exercise 0

仍然是使用 meld 完成半自动移植。

## Exercise 1

### 实验原理

首先判断一个虚地址是否有对应的物理地址。若没有，就要分配页，并建立物理地址和逻辑地址之间的联系；若有，就要从磁盘将这个 page 换入(swap-in)，并建立好物理地址和逻辑地址间的映射。

### 思考问题

> 请描述页目录项 (PDE) 和页表项 (PTE) 中组成部分对 ucore 实现页替换算法的潜在用处。

> 如果 ucore 的缺页服务例程在执行过程中访问内存出现了页访问异常，请问硬件要做哪些事情？

设置 CR2 寄存器。

## Exercise 2

### 实验原理

维护一个队列，每次新加入的页都添加在队首。旧的页从队尾出队，这就是 FIFO 算法。

### 思考问题

> 如果要在ucore上实现"extended clock页替换算法，请给你的设计方案，现有的swap_manager框架是否足以支持在ucore中实现此算法？如果是，请给你的设计方案。如果不是，请给出你的新的扩展和基此扩展的设计方案。并需要回答如下问题：1. 需要被换出的页的特征是什么？2. 在 ucore 中如何判断具有这样特征的页？3. 何时进行换入和换出操作？

可以在 PTE 里设置两位分别表示页是否被访问过（访问位）和是否被修改过（修改位）。

换出的页的特征是访问位和修改位都是 0 。只需要判断 PTE 中的这两位的值就可以了。

换入操作在 page fault 的时候进行；换出可以有积极和消极两种，积极是循环扫描换出，消极是只有当没有空闲页的时候才换出。
